// Generated by CoffeeScript 1.6.1
var genererIdentifiant;

($(document)).ready(function() {
  ($('form')).submit(function(event) {
    return event.preventDefault();
  });
  return ($('#enregistrer')).click(function() {
    if (!verifierErreur(true)) {
      return envoyerFormulaire("POST", "/admin/ajouter", false);
    }
  });
});

($(document)).ready(function() {
  return ($('#generer')).click(function(event) {
    event.preventDefault();
    return genererIdentifiant();
  });
});

($(document)).ready(function() {
  return ($('#titre, #_id, #auteur')).keydown(function(event) {
    if (event.keyCode === 13) {
      event.preventDefault();
      return false;
    }
  });
});

($(document)).ready(function() {
  return ($('#generer')).popover({
    placement: 'right',
    trigger: 'hover',
    title: 'Générer un identifiant',
    content: 'Génère un identifiant à partir du titre. Faites attention, l\'identifiant actuel sera écrasé.'
  });
});

genererIdentifiant = function() {
  var titre;
  titre = ($('#titre')).val().trim();
  if (!(titre === '')) {
    titre = titre.toLowerCase();
    titre = titre.replace(/é|è|ê|ë/g, 'e').replace(/à|â|ä/g, 'a').replace(/î|ï/g, 'i').replace(/ô|ö/g, 'o').replace(/ç/g, 'c').replace(/\s+/g, '-').replace(/[!@\/\\$%?&*():;.,'"{}]|[\u0080-\uFFFF]/g, '');
    titre = titre.substring(0, 50);
    if ((titre.charAt(49)) === "-") {
      titre = titre.substring(0, 49);
    }
    return ($('#_id')).val(titre);
  }
};
