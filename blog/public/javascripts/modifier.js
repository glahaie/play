// Generated by CoffeeScript 1.6.1
var changerModal, supprimer;

($(document)).ready(function() {
  ($('form')).submit(function(event) {
    return event.preventDefault();
  });
  return ($('#enregistrer')).click(function(event) {
    if (!verifierErreur(false)) {
      return envoyerFormulaire("PUT", "/admin/modifier", true);
    }
  });
});

($(document)).ready(function() {
  return ($('#supprimer')).click(function(event) {
    return supprimer();
  });
});

($(document)).ready(function() {
  return ($('#titre, #auteur')).keydown(function(event) {
    if (event.keyCode === 13) {
      event.preventDefault();
      return false;
    }
  });
});

supprimer = function() {
  var message;
  message = {};
  message.id = ($('#_id')).val();
  return $.ajax({
    type: "DELETE",
    url: "/admin/effacer",
    data: message,
    dataType: 'json',
    success: function(data) {
      return changerModal(data);
    },
    error: function(request, status, error) {
      return ($('.modal-body p')).html("Erreur lors de la suppression");
    }
  });
};

changerModal = function(data) {
  ($('.modal-body p')).html(data.message);
  ($('#annuler')).remove();
  ($('.close')).remove();
  ($('#supprimer')).unbind('click');
  ($('#supprimer')).html("Retourner Ã  la page d'accueil");
  return ($('#supprimer')).click(function() {
    return window.location = '/';
  });
};
